Q. Who has max salary in LD department

sq. what is max salary of LD department
select max(salary)
from employees
where dept_code ='LD'   /*single row subquery*/
output = 90000     =, >, <, >=, <=, !=

Final Query:
    
select employees_id, first_name, salary
from employees
where dept_code ='LD' 
and salary = (
    select max(salary)
from employees
where dept_code ='LD'
)

Q. Who has greater salary than salary of employee with id 121? /* single row sq */
    select employees_id, salary from employees 
    where salary>(select salary from employees where employees_id=121)

Q. Who from SM department has greater salary than salary of employee with id 121? 


select *
from employees
where dept_code='SM'
and salary>(select salary from employees where employees_id=121)

select * from employees
where salary>(select salary from employees where employees_id=121)
and dept_code='SM'


Q. Which single employee from city pune has lowest commission than the commission of employee with id 131

1. commission of 131  : 3000 single row subq
2. min(commission) from pune lower than 3000 : 1000
3. find that employee from pune having commission 1000

    
SELECT *
FROM employees
WHERE LOWER(TRIM(city)) = 'pune'
AND commission < (SELECT commission FROM employees WHERE employees_id = 131)
ORDER BY commission ASC
FETCH FIRST 1 ROWS ONLY;

/*nested subquery*/
select * from employees 
where lower(trim(city))='pune'
and commission=
(select min(commission)
from employees
where lower(trim(city))='pune'
and commission<(select commission from employees where employees_id=131))


Q. Show younger employee from SM department whose age is less than youngest employee from WD department

SELECT employees_id, first_name, age
FROM employees
WHERE dept_code = 'SM'
  AND age < (SELECT MIN(age) FROM employees WHERE dept_code = 'WD');


Q. Who earns same as employees from LD department 

sq. select distinct salary from employees where dept_code='LD' /*multi row sub query*/  /*in, not in, =any,  <any, >any , = all, < all, >all*/
main 
    below query gives error /*single-row subquery returns more than one row*/
    select * from employees
where dept_code !='LD' and
 salary = (
    select distinct salary from employees where dept_code='LD'
)

 select * from employees
where dept_code !='LD' and
 salary in (
   select distinct salary from employees where dept_code='LD'
)

